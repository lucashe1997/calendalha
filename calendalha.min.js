function calendalha(target,options){(options=options||[]).textAlign=options.textAlign||"center",options.onDayClick=options.onDayClick||function(){},options.onMonthChange=options.onMonthChange||function(){},options.locale=options.locale||"",options.initDate=options.initDate||moment().format("YYYY-MM-DD"),options.markedDates=options.markedDates||[],options.initDayActive=options.initDayActive||!1,options.renderCustomDay=options.renderCustomDay||!1,options.celVAlign=options.celVAlign||"top",options.custLeftArrow=options.custLeftArrow||"&lt;&lt;",options.custRightArrow=options.custRightArrow||"&gt;&gt;",options.weekFormat=options.weekFormat||"dddd",options.monthFormat=options.monthFormat||"MMMM",currentDay=moment().format("DD"),currentMonth=moment().format("MM"),currentYear=moment().format("YYYY"),options.initDate=moment(options.initDate);var monthChange=0,storedDay,storedMonth,storedYear,actualMonth,actualYear;function staticContent(){function appendMarkup(){var str=`<div class="calendalha-control" style="-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none; "><span class="prev">${options.custLeftArrow}</span><div><span class="month"></span>&nbsp;<span class="year"></span></div><span class="next">${options.custRightArrow}</span></caption></div>`;str+=`<table class="calendalha" style="-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none; text-align:${options.textAlign}"><thead><tr></tr></thead><tbody></tbody></table>`,$(target).append(str)}function tableHead(){var th;for(i=0;i<=6;i++)th+="<th>"+moment().isoWeekday(i).format(options.weekFormat)+"</th>";$(target+" table thead tr").append(th)}appendMarkup(),tableHead()}function dynamicContent(change,activeDay){function appendHeadline(month,year){actualMonth=month,actualYear=year,month=moment(month,"MM").format(options.monthFormat),$(target+" .calendalha-control .month").text(month),$(target+" .calendalha-control .year").text(year)}function appendDays(month,year,push){var appendStr,value;for(theFirst=parseInt(moment(month+"-01-"+year,"MM-DD-YYYY").format("e"),10),index=1,push=index-theFirst,daysInMonth=moment(calendarMonth+"-"+calendarYear,"MM-YYYY").daysInMonth(),x=0,i=push;i<=daysInMonth;i++){value=moment(year+"-"+month+"-"+i,"YYYY-MM-D").format("YYYY-MM-DD"),x++;var string=i;!1!==options.renderCustomDay&&(string=options.renderCustomDay(i,moment(year+"-"+month+"-"+i,"YYYY-MM-D"))),1===x?i>0?appendStr+=`<tr valign="${options.celVAlign}"><td data-value="${value}">${string}</td>`:appendStr+=`<tr valign="${options.celVAlign}"><td disabled></td>`:7===x?(appendStr+=`<td valign="${options.celVAlign}" data-value="${value}">${string}</td></tr>`,x=0):i>0?appendStr+=`<td valign="${options.celVAlign}" data-value="${value}">${string}</td>`:appendStr+=`<td valign="${options.celVAlign}" disabled></td>`}if(0!==x)for(i=1;i<=7-x;i++)appendStr+="<td disabled></td>";appendStr+="</tr>",$(target+" table tbody tr").remove(),$(target+" table tbody").append(appendStr)}activeDay=activeDay||null,monthChange+=change=change||0,newDate=moment(options.initDate).add(monthChange,"months"),calendarMonth=newDate.format("MM"),calendarYear=newDate.format("YYYY"),this.styleDays=function(){storedMonth==calendarMonth&&storedYear==calendarYear?activeMonth=1:activeMonth=0,$(target+" table tbody td").each(function(){calendarDate=parseInt($(this).text(),10),calendarDate<1&&$(this).html(""),calendarDate==currentDay&&calendarMonth==currentMonth&&calendarYear==currentYear&&$(this).addClass("currentDay"),options.initDate.format("YYYYMMDD")==calendarYear+calendarMonth+calendarDate&&options.initDayActive&&$(this).addClass("active"),1==activeMonth&&storedDay==calendarDate&&$(this).addClass("active"),options.markedDates.includes($(this).attr("data-value"))&&$(this).addClass("marked")})},null===activeDay?(appendHeadline(calendarMonth,calendarYear),appendDays(calendarMonth,calendarYear),this.styleDays()):(storedDay=activeDay,storedMonth=calendarMonth,storedYear=calendarYear,$(target+" tbody td").each(function(){tdDays=$(this).text(),activeDay==tdDays?$(this).addClass("active"):$(this).removeClass("active")}))}return staticContent(),dynamicContent(),options.onMonthChange(actualMonth,actualYear),$(target+" .prev").click(function(){dynamicContent(-1),options.onMonthChange(actualMonth,actualYear)}),$(target+" .next").click(function(){dynamicContent(1),options.onMonthChange(actualMonth,actualYear)}),$(target+" table").delegate("tbody td","click",function(){$(this).attr("disabled")||(day=$(this).text(),options.onDayClick($(this).attr("data-value")),dynamicContent(null,day))}),this}